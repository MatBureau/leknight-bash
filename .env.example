# LeKnight Environment Configuration
# Copy this file to .env and fill in your values

# ============================================
# NOTIFICATION SETTINGS
# ============================================

# Discord Webhook (https://discord.com/developers/webhooks)
# Create a webhook in Discord: Server Settings > Integrations > Webhooks > New Webhook
DISCORD_WEBHOOK="https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN"

# Telegram Bot Configuration
# 1. Create bot with @BotFather on Telegram
# 2. Get token from @BotFather
# 3. Get chat ID by messaging @userinfobot
TELEGRAM_BOT_TOKEN="your_bot_token_here"
TELEGRAM_CHAT_ID="your_chat_id_here"

# Email Notifications
# Requires mail or sendmail to be configured on the system
ALERT_EMAIL="security-team@example.com"

# Minimum severity to trigger notifications (critical, high, medium, low, info)
NOTIFICATION_MIN_SEVERITY="medium"

# ============================================
# API KEYS (Optional Integrations)
# ============================================

# Shodan API Key (https://account.shodan.io/)
SHODAN_API_KEY="your_shodan_api_key"

# VirusTotal API Key (https://www.virustotal.com/gui/user/apikey)
VIRUSTOTAL_API_KEY="your_virustotal_api_key"

# ============================================
# AUTOPILOT SETTINGS
# ============================================

# Maximum concurrent scans (requires GNU parallel)
AUTOPILOT_PARALLEL_SCANS=5

# Maximum autopilot iterations
AUTOPILOT_MAX_ITERATIONS=10

# Delay between scans (seconds)
AUTOPILOT_SCAN_DELAY=2

# Maximum scan depth (how many levels of recursive discovery)
AUTOPILOT_MAX_DEPTH=3

# ============================================
# RATE LIMITING
# ============================================

# Enable rate limiting to avoid IP bans
RATE_LIMITING_ENABLED=true

# Maximum requests per second
MAX_REQUESTS_PER_SECOND=10

# Enable automatic backoff on HTTP 429 responses
BACKOFF_ON_429=true

# ============================================
# SECURITY SETTINGS
# ============================================

# Strict scope validation (block scans outside defined scope)
STRICT_SCOPE_VALIDATION=true

# Enable command validation (block dangerous commands)
COMMAND_VALIDATION=true

# ============================================
# JIRA INTEGRATION (Optional)
# ============================================

# Jira Configuration
JIRA_URL="https://your-company.atlassian.net"
JIRA_USER="your-email@example.com"
JIRA_API_TOKEN="your_jira_api_token"
JIRA_PROJECT="SEC"  # Project key for security issues

# ============================================
# THEHIVE INTEGRATION (Optional)
# ============================================

# TheHive Configuration
THEHIVE_URL="http://thehive.local:9000"
THEHIVE_API_KEY="your_thehive_api_key"

# ============================================
# LOGGING
# ============================================

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LEKNIGHT_LOG_LEVEL=INFO

# Enable JSON formatted logs
JSON_LOGGING=false
